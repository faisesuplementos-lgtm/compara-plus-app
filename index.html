<script>
async function buscar(termoManual = null) {
  const input = document.getElementById("searchInput");
  const results = document.getElementById("results");
  const termo = termoManual || input.value;

  if (!termo) {
    alert("Digite um produto");
    return;
  }

  results.innerHTML = "<div class='card'>Buscando...</div>";

  try {
    const response = await fetch(
      `/api/search?q=${encodeURIComponent(termo)}`
    );

    const data = await response.json();
    const items = data.results.slice(0, 8);

    results.innerHTML = "";

    if (!items || items.length === 0) {
      results.innerHTML = "<div class='card'>Nenhum produto encontrado</div>";
      return;
    }

    items.forEach(item => {
      const price = item.price.toLocaleString("pt-BR", {
        style: "currency",
        currency: "BRL"
      });

      results.innerHTML += `
        <div class="card">
          <img src="${item.thumbnail}">
          <h3>${item.title}</h3>
          <div class="price">${price}</div>
          <a href="${item.permalink}" target="_blank">
            <button>Ver no Mercado Livre</button>
          </a>
        </div>
      `;
    });

  } catch (error) {
    console.error(error);
    results.innerHTML = "<div class='card'>Erro ao buscar produtos</div>";
  }
}

window.onload = function() {
  buscar("mais vendidos");
};
</script>




