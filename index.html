<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compara+ | Compare PreÃ§os</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',Arial,sans-serif;background:#0a0e1a;color:#fff;min-height:100vh;}
a{text-decoration:none;}

/* â”€â”€â”€ HEADER â”€â”€â”€ */
header{
  background:linear-gradient(90deg,#0a0e1a,#0f1e30,#0f62fe18);
  border-bottom:1px solid #ffffff12;
  padding:0 24px;
  position:sticky;top:0;z-index:999;
  backdrop-filter:blur(14px);
}
.header-inner{
  max-width:1280px;margin:auto;
  display:flex;align-items:center;justify-content:space-between;
  height:66px;gap:16px;
}
.logo{font-size:1.65rem;font-weight:900;white-space:nowrap;letter-spacing:-0.5px;}
.logo span{color:#0f62fe;}
.logo small{font-size:0.65rem;background:#0f62fe;padding:2px 7px;border-radius:20px;vertical-align:middle;font-weight:700;margin-left:4px;}

nav{display:flex;gap:4px;}
nav button{
  background:transparent;border:none;color:#bbb;
  padding:8px 13px;border-radius:9px;cursor:pointer;
  font-size:0.86rem;font-weight:600;transition:all 0.2s;white-space:nowrap;
}
nav button:hover,nav button.active{background:#0f62fe;color:#fff;}

.header-search{display:flex;flex:1;max-width:420px;}
.header-search input{
  flex:1;padding:10px 15px;border-radius:10px 0 0 10px;
  border:1.5px solid #0f62fe55;background:#ffffff0e;
  color:#fff;font-size:0.93rem;outline:none;transition:0.2s;
}
.header-search input:focus{border-color:#0f62fe;}
.header-search input::placeholder{color:#777;}
.header-search button{
  padding:10px 17px;background:#0f62fe;border:none;
  border-radius:0 10px 10px 0;color:#fff;cursor:pointer;font-size:1.1rem;
  transition:0.2s;
}
.header-search button:hover{background:#0050d0;}

/* â”€â”€â”€ PÃGINAS â”€â”€â”€ */
.page{display:none;max-width:1280px;margin:auto;padding:32px 24px;}
.page.active{display:block;}

/* â”€â”€â”€ HERO â”€â”€â”€ */
.hero{
  background:linear-gradient(135deg,#0b1220,#0f2744,#0f62fe28);
  border-radius:22px;padding:64px 44px;text-align:center;
  margin-bottom:44px;border:1px solid #0f62fe22;
  position:relative;overflow:hidden;
}
.hero::before{
  content:'';position:absolute;top:-60%;left:-60%;
  width:220%;height:220%;
  background:radial-gradient(circle,#0f62fe0e 0%,transparent 55%);
  animation:pulse 5s ease-in-out infinite;
}
@keyframes pulse{0%,100%{transform:scale(1);opacity:0.4;}50%{transform:scale(1.08);opacity:1;}}
.hero-tag{
  display:inline-block;background:#0f62fe22;border:1px solid #0f62fe55;
  color:#6ba3ff;font-size:0.78rem;font-weight:700;
  padding:5px 14px;border-radius:20px;margin-bottom:18px;position:relative;
}
.hero h2{font-size:3rem;font-weight:900;margin-bottom:14px;position:relative;line-height:1.15;}
.hero h2 span{color:#0f62fe;}
.hero p{opacity:0.75;font-size:1.05rem;margin-bottom:36px;position:relative;line-height:1.6;}
.hero-search{
  display:flex;max-width:620px;margin:auto;position:relative;
  box-shadow:0 0 50px #0f62fe33;border-radius:14px;
}
.hero-search input{
  flex:1;padding:18px 22px;border-radius:14px 0 0 14px;
  border:2px solid #0f62fe;background:#ffffff0d;
  color:#fff;font-size:1.05rem;outline:none;
}
.hero-search input::placeholder{color:#888;}
.hero-search button{
  padding:18px 28px;background:#0f62fe;border:none;
  border-radius:0 14px 14px 0;color:#fff;font-size:1rem;
  cursor:pointer;font-weight:700;transition:0.2s;white-space:nowrap;
}
.hero-search button:hover{background:#0050d0;}

/* â”€â”€â”€ PLATFORMS STRIP â”€â”€â”€ */
.platforms-strip{
  display:flex;justify-content:center;gap:18px;flex-wrap:wrap;
  margin-top:28px;position:relative;
}
.plat-badge{
  display:flex;align-items:center;gap:7px;
  background:#ffffff08;border:1px solid #ffffff14;
  padding:7px 16px;border-radius:30px;font-size:0.82rem;font-weight:700;
}

/* â”€â”€â”€ STATS â”€â”€â”€ */
.stats{
  display:flex;justify-content:center;gap:40px;flex-wrap:wrap;
  margin-top:28px;position:relative;
}
.stat{text-align:center;}
.stat-number{font-size:1.6rem;font-weight:900;color:#0f62fe;}
.stat-label{font-size:0.75rem;color:#888;margin-top:2px;}

/* â”€â”€â”€ SECTION TITLE â”€â”€â”€ */
.section-title{
  font-size:1.35rem;font-weight:800;margin-bottom:18px;
  display:flex;align-items:center;gap:10px;
}
.section-title span{color:#0f62fe;}
.section-title a{
  margin-left:auto;font-size:0.8rem;color:#0f62fe;
  font-weight:600;cursor:pointer;opacity:0.8;
}
.section-title a:hover{opacity:1;}

/* â”€â”€â”€ CHIPS â”€â”€â”€ */
.chips{display:flex;gap:9px;flex-wrap:wrap;margin-bottom:24px;}
.chip{
  padding:8px 18px;border-radius:30px;border:1.5px solid #ffffff1a;
  background:#ffffff08;color:#bbb;cursor:pointer;font-size:0.84rem;
  font-weight:600;transition:0.2s;white-space:nowrap;
}
.chip:hover,.chip.active{background:#0f62fe;border-color:#0f62fe;color:#fff;}

/* â”€â”€â”€ GRID PRODUTOS â”€â”€â”€ */
.products-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(210px,1fr));
  gap:18px;margin-bottom:44px;
}

/* â”€â”€â”€ CARD â”€â”€â”€ */
.card{
  background:linear-gradient(160deg,#111827,#192240);
  border:1px solid #ffffff0f;border-radius:16px;
  overflow:hidden;transition:all 0.25s;
  display:flex;flex-direction:column;
  position:relative;
}
.card:hover{transform:translateY(-6px);border-color:#0f62fe55;box-shadow:0 12px 36px #0f62fe22;}
.card-ribbon{
  position:absolute;top:10px;left:10px;z-index:2;
  display:flex;gap:5px;flex-wrap:wrap;
}
.card-img{
  width:100%;height:180px;object-fit:contain;
  background:#ffffff07;padding:14px;transition:0.3s;
}
.card:hover .card-img{transform:scale(1.05);}
.card-body{padding:14px;flex:1;display:flex;flex-direction:column;gap:8px;}
.card-store{
  font-size:0.7rem;font-weight:700;padding:3px 9px;
  border-radius:20px;display:inline-block;width:fit-content;
}
.store-ml{background:#ffe60018;color:#ffe600;border:1px solid #ffe60033;}
.store-shopee{background:#ee4d2d18;color:#ff6b4a;border:1px solid #ee4d2d33;}
.store-magalu{background:#0086ff18;color:#4db3ff;border:1px solid #0086ff33;}
.store-shein{background:#ff006618;color:#ff66aa;border:1px solid #ff006633;}
.card-title{font-size:0.82rem;color:#d0d8e8;line-height:1.45;flex:1;
  display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;}
.card-price{font-size:1.2rem;font-weight:900;color:#fff;}
.card-installment{font-size:0.73rem;color:#999;}
.card-btn{
  display:block;text-align:center;
  padding:10px;background:#0f62fe;color:#fff;
  border-radius:9px;font-weight:700;font-size:0.84rem;
  margin-top:auto;transition:0.2s;border:none;cursor:pointer;
}
.card-btn:hover{background:#0050d0;color:#fff;}

/* BADGES */
.badge{font-size:0.68rem;font-weight:800;padding:3px 9px;border-radius:20px;display:inline-block;}
.badge-cheap{background:#00d084;color:#000;}
.badge-hot{background:linear-gradient(90deg,#ff4444,#ff8800);color:#fff;}
.card-cheapest{border-color:#00d08455 !important;box-shadow:0 0 22px #00d08422 !important;}

/* â”€â”€â”€ PLATAFORMAS BUSCA â”€â”€â”€ */
.platform-tabs{
  display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap;
}
.ptab{
  padding:9px 20px;border-radius:10px;border:1.5px solid #ffffff15;
  background:#ffffff08;color:#aaa;cursor:pointer;font-size:0.85rem;
  font-weight:700;transition:0.2s;display:flex;align-items:center;gap:6px;
}
.ptab:hover{background:#ffffff12;}
.ptab.active-ml{background:#ffe60020;border-color:#ffe60066;color:#ffe600;}
.ptab.active-shopee{background:#ee4d2d20;border-color:#ee4d2d66;color:#ff6b4a;}
.ptab.active-magalu{background:#0086ff20;border-color:#0086ff66;color:#4db3ff;}
.ptab.active-shein{background:#ff006620;border-color:#ff006666;color:#ff66aa;}

/* â”€â”€â”€ COMPARE TABLE â”€â”€â”€ */
.compare-section{
  background:#ffffff06;border:1px solid #ffffff10;
  border-radius:14px;padding:20px;margin-bottom:24px;
}
.compare-section h3{font-size:1rem;font-weight:800;margin-bottom:14px;color:#88aaff;}
.compare-row{
  display:flex;align-items:center;justify-content:space-between;
  padding:12px 0;border-bottom:1px solid #ffffff08;gap:12px;flex-wrap:wrap;
}
.compare-row:last-child{border-bottom:none;}
.compare-store{display:flex;align-items:center;gap:8px;font-weight:700;font-size:0.88rem;min-width:130px;}
.compare-price{font-size:1.1rem;font-weight:900;color:#fff;}
.compare-btn{
  padding:8px 16px;border-radius:8px;color:#fff;font-weight:700;
  font-size:0.8rem;border:none;cursor:pointer;text-decoration:none;
  display:inline-block;transition:0.2s;white-space:nowrap;
}
.btn-ml{background:#ffe600;color:#000;}
.btn-shopee{background:#ee4d2d;}
.btn-magalu{background:#0086ff;}
.btn-shein{background:#ff0066;}
.compare-cheapest-label{
  font-size:0.7rem;background:#00d084;color:#000;
  padding:2px 8px;border-radius:10px;font-weight:800;
}

/* â”€â”€â”€ ORDER BAR â”€â”€â”€ */
.order-bar{
  display:flex;align-items:center;gap:10px;margin-bottom:22px;flex-wrap:wrap;
  background:#ffffff06;padding:14px 18px;border-radius:12px;
  border:1px solid #ffffff0a;
}
.order-bar span{font-size:0.88rem;color:#888;font-weight:600;}
.order-btn{
  padding:7px 16px;border-radius:8px;border:1.5px solid #0f62fe44;
  background:transparent;color:#88aaff;cursor:pointer;font-size:0.83rem;
  font-weight:600;transition:0.2s;
}
.order-btn.active,.order-btn:hover{background:#0f62fe;color:#fff;border-color:#0f62fe;}

/* â”€â”€â”€ SEARCH HEADER â”€â”€â”€ */
.search-header{
  display:flex;align-items:center;justify-content:space-between;
  flex-wrap:wrap;gap:12px;margin-bottom:16px;
}
.search-header h2{font-size:1.3rem;font-weight:800;}
.result-count{
  background:#0f62fe18;border:1px solid #0f62fe33;
  padding:5px 15px;border-radius:20px;font-size:0.83rem;color:#88aaff;font-weight:600;
}

/* â”€â”€â”€ CUPONS â”€â”€â”€ */
.coupons-grid{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));
  gap:16px;margin-bottom:40px;
}
.coupon-card{
  background:linear-gradient(135deg,#0f1e35,#0f62fe18);
  border:1.5px dashed #0f62fe44;border-radius:15px;
  padding:20px;display:flex;gap:16px;align-items:center;
  transition:0.2s;
}
.coupon-card:hover{border-color:#0f62fe99;box-shadow:0 0 24px #0f62fe18;}
.coupon-icon{font-size:2.4rem;flex-shrink:0;}
.coupon-info h4{font-size:1rem;font-weight:800;margin-bottom:3px;}
.coupon-info p{font-size:0.78rem;color:#999;margin-bottom:8px;line-height:1.4;}
.coupon-savings{font-size:0.78rem;color:#00d084;font-weight:800;margin-bottom:8px;}
.coupon-code{
  background:#0f62fe;color:#fff;padding:5px 14px;
  border-radius:7px;font-size:0.8rem;font-weight:700;
  display:inline-block;letter-spacing:1.5px;cursor:pointer;
  transition:0.2s;user-select:none;
}
.coupon-code:hover{background:#0050d0;transform:scale(1.04);}

/* â”€â”€â”€ LOADING â”€â”€â”€ */
.loading{
  text-align:center;padding:70px 20px;
  display:flex;flex-direction:column;align-items:center;gap:16px;
  grid-column:1/-1;
}
.spinner{
  width:48px;height:48px;border:4px solid #ffffff15;
  border-top:4px solid #0f62fe;border-radius:50%;
  animation:spin 0.8s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg);}}
.loading p{color:#888;font-size:0.9rem;}

/* â”€â”€â”€ ERRO / VAZIO â”€â”€â”€ */
.error-box{
  text-align:center;padding:55px 20px;
  background:#ff444418;border:1.5px solid #ff4444;
  border-radius:15px;grid-column:1/-1;
}
.error-box h3{color:#ff7777;font-size:1.2rem;margin-bottom:10px;}
.error-box p{color:#999;font-size:0.88rem;}
.empty-box{
  text-align:center;padding:70px 20px;opacity:0.55;grid-column:1/-1;
}
.empty-box .icon{font-size:4.5rem;margin-bottom:16px;}
.empty-box h3{font-size:1.2rem;margin-bottom:8px;}
.empty-box p{font-size:0.88rem;color:#999;}

/* â”€â”€â”€ TOAST â”€â”€â”€ */
.toast{
  position:fixed;bottom:28px;right:28px;
  background:#0f62fe;color:#fff;padding:13px 22px;
  border-radius:12px;font-weight:600;font-size:0.88rem;
  box-shadow:0 6px 24px #0f62fe44;
  transform:translateY(120px);opacity:0;
  transition:all 0.35s cubic-bezier(.22,.68,0,1.3);z-index:9999;
}
.toast.show{transform:translateY(0);opacity:1;}

/* â”€â”€â”€ FOOTER â”€â”€â”€ */
footer{
  text-align:center;padding:32px 20px;
  border-top:1px solid #ffffff0d;
  color:#555;font-size:0.82rem;margin-top:40px;
}
footer span{color:#0f62fe;font-weight:700;}
footer p+p{margin-top:6px;}

/* â”€â”€â”€ MOBILE NAV â”€â”€â”€ */
.mobile-nav{
  display:none;
  position:fixed;bottom:0;left:0;right:0;
  background:#0d1320;border-top:1px solid #ffffff10;
  padding:8px 0 10px;z-index:998;
}
.mobile-nav-inner{display:flex;justify-content:space-around;max-width:500px;margin:auto;}
.mobile-nav-btn{
  display:flex;flex-direction:column;align-items:center;
  gap:3px;background:none;border:none;color:#888;
  cursor:pointer;font-size:0.62rem;font-weight:600;
  padding:4px 10px;border-radius:10px;transition:0.2s;
}
.mobile-nav-btn .mnav-icon{font-size:1.4rem;line-height:1;}
.mobile-nav-btn.active,.mobile-nav-btn:hover{color:#0f62fe;}

/* â”€â”€â”€ CARD PLATFORM LINKS â”€â”€â”€ */
.card-platforms{
  margin-top:8px;padding-top:8px;
  border-top:1px solid #ffffff0d;
}
.cp-label{
  font-size:0.68rem;color:#777;font-weight:600;
  display:block;margin-bottom:6px;
}
.cp-btns{display:flex;gap:5px;flex-wrap:wrap;}
.cp-btn{
  font-size:0.7rem;font-weight:700;padding:5px 9px;
  border-radius:7px;text-decoration:none;transition:0.2s;
  display:inline-flex;align-items:center;gap:3px;
  white-space:nowrap;line-height:1.3;
}
.cp-btn:hover{opacity:0.9;transform:translateY(-2px);}
.cp-shopee{background:#ee4d2d18;color:#ff6b4a;border:1px solid #ee4d2d44;}
.cp-magalu{background:#0086ff18;color:#4db3ff;border:1px solid #0086ff44;}
.cp-shein {background:#ff006618;color:#ff66aa;border:1px solid #ff006644;}
.cp-est{font-size:0.58rem;opacity:0.6;font-weight:500;}

/* â”€â”€â”€ INFO BANNER â”€â”€â”€ */
.info-banner{
  background:linear-gradient(90deg,#0f62fe15,#00d08415);
  border:1px solid #0f62fe33;border-radius:12px;
  padding:12px 20px;margin-bottom:20px;font-size:0.84rem;
  color:#88aaff;display:flex;align-items:center;gap:10px;
}

/* â”€â”€â”€ RESPONSIVE â”€â”€â”€ */
@media(max-width:700px){
  .hero{padding:44px 20px;}
  .hero h2{font-size:2rem;}
  .hero p{font-size:0.95rem;}
  nav{display:none;}
  .mobile-nav{display:block;}
  .header-search{max-width:100%;}
  .logo small{display:none;}
  .products-grid{grid-template-columns:repeat(auto-fill,minmax(158px,1fr));gap:12px;}
  body{padding-bottom:72px;}
  .stats{gap:24px;}
  .page{padding:24px 16px;}
}
@media(max-width:400px){
  .products-grid{grid-template-columns:1fr 1fr;}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header>
  <div class="header-inner">
    <div class="logo">ğŸ’° Compara<span>+</span><small>BETA</small></div>
    <nav>
      <button class="active" onclick="goPage('home')">ğŸ  InÃ­cio</button>
      <button onclick="goPage('ofertas')">ğŸ”¥ Ofertas</button>
      <button onclick="goPage('mais-buscados')">ğŸ“ˆ Mais Buscados</button>
      <button onclick="goPage('mais-vendidos')">ğŸ† Mais Vendidos</button>
      <button onclick="goPage('cupons')">ğŸŸï¸ Cupons</button>
    </nav>
    <div class="header-search">
      <input type="text" id="headerSearch" placeholder="Buscar produto...">
      <button onclick="doSearch(document.getElementById('headerSearch').value)">ğŸ”</button>
    </div>
  </div>
</header>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MOBILE NAV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="mobile-nav">
  <div class="mobile-nav-inner">
    <button class="mobile-nav-btn active" onclick="goPage('home')"><span class="mnav-icon">ğŸ </span>InÃ­cio</button>
    <button class="mobile-nav-btn" onclick="goPage('ofertas')"><span class="mnav-icon">ğŸ”¥</span>Ofertas</button>
    <button class="mobile-nav-btn" onclick="goPage('mais-buscados')"><span class="mnav-icon">ğŸ“ˆ</span>Buscados</button>
    <button class="mobile-nav-btn" onclick="goPage('mais-vendidos')"><span class="mnav-icon">ğŸ†</span>Vendidos</button>
    <button class="mobile-nav-btn" onclick="goPage('cupons')"><span class="mnav-icon">ğŸŸï¸</span>Cupons</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-home" class="page active">
  <div class="hero">
    <div class="hero-tag">âš¡ Comparador de PreÃ§os #1 do Brasil</div>
    <h2>Compare e economize<br><span>nos melhores produtos</span></h2>
    <p>Busque qualquer produto e veja os resultados ordenados<br>do mais barato ao mais caro â€” com link de afiliado incluso.</p>
    <div class="hero-search">
      <input type="text" id="heroSearch" placeholder="Ex: iPhone 15, Notebook Gamer, Fone Bluetooth...">
      <button onclick="doSearch(document.getElementById('heroSearch').value)">ğŸ” Buscar Agora</button>
    </div>
    <div class="platforms-strip">
      <div class="plat-badge">ğŸŸ¡ Mercado Livre</div>
      <div class="plat-badge">ğŸŸ  Shopee</div>
      <div class="plat-badge">ğŸ”µ Magalu</div>
      <div class="plat-badge">ğŸ©· Shein</div>
    </div>
    <div class="stats">
      <div class="stat"><div class="stat-number">20+</div><div class="stat-label">Resultados por busca</div></div>
      <div class="stat"><div class="stat-number">4</div><div class="stat-label">Plataformas integradas</div></div>
      <div class="stat"><div class="stat-number">100%</div><div class="stat-label">Gratuito e direto</div></div>
    </div>
  </div>

  <div class="section-title">ğŸ—‚ï¸ Categorias <span>Populares</span></div>
  <div class="chips" id="homeChips">
    <div class="chip active" onclick="selectChip(this,'')">âœ¨ Todos</div>
    <div class="chip" onclick="selectChip(this,'smartphone')">ğŸ“± Smartphones</div>
    <div class="chip" onclick="selectChip(this,'notebook')">ğŸ’» Notebooks</div>
    <div class="chip" onclick="selectChip(this,'fone bluetooth')">ğŸ§ Fones</div>
    <div class="chip" onclick="selectChip(this,'smart tv')">ğŸ“º Smart TVs</div>
    <div class="chip" onclick="selectChip(this,'playstation xbox games')">ğŸ® Games</div>
    <div class="chip" onclick="selectChip(this,'camera fotografica')">ğŸ“· CÃ¢meras</div>
    <div class="chip" onclick="selectChip(this,'tablet')">ğŸ–¥ï¸ Tablets</div>
    <div class="chip" onclick="selectChip(this,'smartwatch relogio')">âŒš Smartwatches</div>
    <div class="chip" onclick="selectChip(this,'ar condicionado')">â„ï¸ Ar-condicionado</div>
    <div class="chip" onclick="selectChip(this,'aspirador robo')">ğŸ¤– Aspiradores</div>
  </div>

  <div class="section-title">âš¡ Destaques <span>do Dia</span> <a onclick="loadHome()">â†» Atualizar</a></div>
  <div id="homeHighlights" class="products-grid">
    <div class="loading"><div class="spinner"></div><p>Carregando destaques...</p></div>
  </div>

  <div class="section-title">ğŸ”¥ Em <span>Alta Agora</span></div>
  <div id="homeTrending" class="products-grid">
    <div class="loading"><div class="spinner"></div><p>Carregando produtos em alta...</p></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BUSCA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-search" class="page">
  <div class="search-header">
    <h2 id="searchTitle">Resultados da busca</h2>
    <div class="result-count" id="resultCount"></div>
  </div>

  <!-- INFO sobre plataformas -->
  <div class="info-banner">
    ğŸ’¡ PreÃ§os reais do <strong>Mercado Livre</strong> via API oficial â€¢ PreÃ§os das outras plataformas sÃ£o <strong>estimativas</strong> â€” clique para ver o valor real em cada loja â€¢ Ordenado do <strong>mais barato ao mais caro</strong>!
  </div>

  <!-- COMPARADOR DE PLATAFORMAS -->
  <div id="compareSection" style="display:none;">
    <div class="compare-section">
      <h3>ğŸ” Buscar este produto em outras plataformas</h3>
      <div id="compareRows"></div>
    </div>
  </div>

  <div class="order-bar">
    <span>Ordenar por:</span>
    <button class="order-btn active" onclick="sortProducts('asc',this)">ğŸ’² Menor PreÃ§o</button>
    <button class="order-btn" onclick="sortProducts('desc',this)">ğŸ’² Maior PreÃ§o</button>
    <button class="order-btn" onclick="sortProducts('rel',this)">â­ RelevÃ¢ncia</button>
  </div>

  <!-- TABS DE PLATAFORMA -->
  <div class="platform-tabs" id="platformTabs">
    <div class="ptab active-ml" id="tab-ml" onclick="showPlatform('ml')">ğŸŸ¡ Mercado Livre <span id="count-ml"></span></div>
    <div class="ptab" id="tab-shopee" onclick="openPlatformSearch('shopee')">ğŸŸ  Shopee â†’</div>
    <div class="ptab" id="tab-magalu" onclick="openPlatformSearch('magalu')">ğŸ”µ Magalu â†’</div>
    <div class="ptab" id="tab-shein" onclick="openPlatformSearch('shein')">ğŸ©· Shein â†’</div>
  </div>

  <div id="searchResults" class="products-grid"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OFERTAS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-ofertas" class="page">
  <div class="section-title">ğŸ”¥ Melhores <span>Ofertas</span></div>
  <div class="chips" id="ofertasChips">
    <div class="chip active" onclick="selectOfertaChip(this,'smartphone')">ğŸ“± Celulares</div>
    <div class="chip" onclick="selectOfertaChip(this,'notebook')">ğŸ’» Notebooks</div>
    <div class="chip" onclick="selectOfertaChip(this,'smart tv')">ğŸ“º TVs</div>
    <div class="chip" onclick="selectOfertaChip(this,'fone bluetooth')">ğŸ§ Fones</div>
    <div class="chip" onclick="selectOfertaChip(this,'relogio smartwatch')">âŒš RelÃ³gios</div>
    <div class="chip" onclick="selectOfertaChip(this,'console games')">ğŸ® Games</div>
    <div class="chip" onclick="selectOfertaChip(this,'tablet')">ğŸ–¥ï¸ Tablets</div>
    <div class="chip" onclick="selectOfertaChip(this,'camera')">ğŸ“· CÃ¢meras</div>
  </div>
  <div id="ofertasGrid" class="products-grid">
    <div class="loading"><div class="spinner"></div><p>Carregando ofertas...</p></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIS BUSCADOS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-mais-buscados" class="page">
  <div class="section-title">ğŸ“ˆ Produtos Mais <span>Buscados</span></div>
  <div class="chips" id="buscadosChips">
    <div class="chip active" onclick="selectBuscadoChip(this,'iPhone')">ğŸ“± iPhone</div>
    <div class="chip" onclick="selectBuscadoChip(this,'Samsung Galaxy')">ğŸŒŒ Samsung</div>
    <div class="chip" onclick="selectBuscadoChip(this,'AirPods')">ğŸ§ AirPods</div>
    <div class="chip" onclick="selectBuscadoChip(this,'PlayStation 5')">ğŸ® PS5</div>
    <div class="chip" onclick="selectBuscadoChip(this,'Xiaomi')">ğŸ“² Xiaomi</div>
    <div class="chip" onclick="selectBuscadoChip(this,'MacBook')">ğŸ’» MacBook</div>
    <div class="chip" onclick="selectBuscadoChip(this,'Nintendo Switch')">ğŸ•¹ï¸ Nintendo</div>
    <div class="chip" onclick="selectBuscadoChip(this,'Kindle')">ğŸ“š Kindle</div>
    <div class="chip" onclick="selectBuscadoChip(this,'Motorola')">ğŸ“± Motorola</div>
    <div class="chip" onclick="selectBuscadoChip(this,'GoPro')">ğŸ¥ GoPro</div>
  </div>
  <div id="maisBuscadosGrid" class="products-grid">
    <div class="loading"><div class="spinner"></div><p>Carregando...</p></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIS VENDIDOS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-mais-vendidos" class="page">
  <div class="section-title">ğŸ† Mais <span>Vendidos</span></div>
  <div class="chips" id="vendidosChips">
    <div class="chip active" onclick="selectVendidoChip(this,'eletronico')">ğŸ† Geral</div>
    <div class="chip" onclick="selectVendidoChip(this,'celular')">ğŸ“± Celulares</div>
    <div class="chip" onclick="selectVendidoChip(this,'notebook')">ğŸ’» Notebooks</div>
    <div class="chip" onclick="selectVendidoChip(this,'fone bluetooth')">ğŸ§ Fones</div>
    <div class="chip" onclick="selectVendidoChip(this,'smart tv')">ğŸ“º TVs</div>
    <div class="chip" onclick="selectVendidoChip(this,'games')">ğŸ® Games</div>
  </div>
  <div class="order-bar" style="margin-top:0;">
    <span>Ordenar:</span>
    <button class="order-btn active" onclick="sortMaisVendidos('asc',this)">ğŸ’² Menor PreÃ§o</button>
    <button class="order-btn" onclick="sortMaisVendidos('desc',this)">ğŸ’² Maior PreÃ§o</button>
  </div>
  <div id="maisVendidosGrid" class="products-grid">
    <div class="loading"><div class="spinner"></div><p>Carregando...</p></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CUPONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-cupons" class="page">
  <div class="section-title">ğŸŸï¸ Cupons e <span>PromoÃ§Ãµes</span></div>
  <div id="cuponsGrid" class="coupons-grid"></div>
  <div class="section-title">ğŸ›ï¸ Produtos com <span>Desconto</span></div>
  <div id="cuponsProducts" class="products-grid">
    <div class="loading"><div class="spinner"></div><p>Carregando promos...</p></div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<!-- FOOTER -->
<footer>
  <p>ğŸ’° <span>Compara+</span> Â© 2026 â€” Compare preÃ§os e economize de verdade</p>
  <p>Resultados via API oficial do Mercado Livre â€¢ Afiliado <span>df20251014105211</span></p>
</footer>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ESTADO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let currentSearchData  = [];
let currentVendidoData = [];
let currentQuery       = '';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LINKS DAS PLATAFORMAS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildShopeeLink(q){
  let url = 'https://shopee.com.br/search?keyword=' + encodeURIComponent(q);
  if(AFFILIATES.shopee) url += '&af_id=' + AFFILIATES.shopee;
  return url;
}
function buildMagaluLink(q){
  let url = 'https://www.magazineluiza.com.br/busca/' + encodeURIComponent(q).replace(/%20/g,'-') + '/';
  if(AFFILIATES.magalu) url += '?partner_id=' + AFFILIATES.magalu;
  return url;
}
function buildSheinLink(q){
  let url = 'https://www.shein.com.br/pdsearch/' + encodeURIComponent(q) + '/';
  if(AFFILIATES.shein) url += '?ref=' + AFFILIATES.shein;
  return url;
}
function buildMlSearchLink(q){
  return 'https://lista.mercadolivre.com.br/' + encodeURIComponent(q).replace(/%20/g,'-') + '?affiliateId=' + AFFILIATES.ml;
}
function affLink(permalink){
  if(!permalink) return '#';
  try{
    const u = new URL(permalink);
    u.searchParams.set('affiliateId', AFFILIATES.ml);
    return u.toString();
  }catch(e){ return permalink + '?affiliateId=' + AFFILIATES.ml; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONFIGURAÃ‡ÃƒO IDs DE AFILIADO
   â¡ Mercado Livre: ativo
   â¡ Shopee / Magalu / Shein: insira quando tiver
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const AFFILIATES = {
  ml:     'df20251014105211',
  shopee: '',   // ex: '123456' â€” insira quando tiver
  magalu: '',   // ex: 'abc123' â€” insira quando tiver
  shein:  ''    // ex: 'xyz789' â€” insira quando tiver
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FETCH MERCADO LIVRE â€” API oficial com CORS
   A API do ML libera CORS para origens HTTPS.
   Tentativas em cascata para mÃ¡xima compatibilidade.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function fetchML(query, limit, sort){
  return new Promise(function(resolve){

    /* â”€â”€ 1Âª tentativa: API interna da Vercel (/api/buscar) â”€â”€ */
    var internalUrl = '/api/buscar?q=' + encodeURIComponent(query);
    if(limit) internalUrl += '&limit=' + limit;
    if(sort)  internalUrl += '&sort='  + sort;

    fetch(internalUrl, {signal: AbortSignal.timeout ? AbortSignal.timeout(8000) : undefined})
      .then(function(r){
        if(!r.ok) throw new Error('status ' + r.status);
        return r.json();
      })
      .then(function(data){
        if(Array.isArray(data) && data.length > 0){
          resolve(data);
        } else {
          throw new Error('vazio');
        }
      })
      .catch(function(){

        /* â”€â”€ 2Âª tentativa: API do ML direto (funciona em HTTPS/Vercel) â”€â”€ */
        var mlUrl = 'https://api.mercadolibre.com/sites/MLB/search?q='
          + encodeURIComponent(query)
          + '&limit=' + (limit || 20);
        if(sort) mlUrl += '&sort=' + sort;

        fetch(mlUrl, {
          headers: { 'Accept': 'application/json' }
        })
          .then(function(r){ return r.json(); })
          .then(function(data){
            var results = (data && Array.isArray(data.results)) ? data.results : [];
            resolve(results);
          })
          .catch(function(){

            /* â”€â”€ 3Âª tentativa: proxy allorigins â”€â”€ */
            var proxy = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(mlUrl);
            fetch(proxy)
              .then(function(r){ return r.json(); })
              .then(function(data){
                var results = (data && Array.isArray(data.results)) ? data.results : [];
                resolve(results);
              })
              .catch(function(){

                /* â”€â”€ 4Âª tentativa: proxy corsproxy.io â”€â”€ */
                var proxy2 = 'https://corsproxy.io/?' + encodeURIComponent(mlUrl);
                fetch(proxy2)
                  .then(function(r){ return r.json(); })
                  .then(function(data){
                    var results = (data && Array.isArray(data.results)) ? data.results : [];
                    resolve(results);
                  })
                  .catch(function(){
                    /* Tudo falhou â€” resolve vazio, UI mostra botÃµes diretos */
                    resolve([]);
                  });
              });
          });
      });
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FORMATAÃ‡ÃƒO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function fmtPrice(v){
  return v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CARD â€” produto do Mercado Livre
   Mostra preÃ§o real do ML + botÃµes de busca
   nas outras plataformas com preÃ§o simulado
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function simPrice(base, pct){
  return base * (1 + pct/100);
}

function createCard(item, isCheapest=false, showPlatformLinks=false){
  const img      = (item.thumbnail||'').replace('-I.jpg','-O.jpg');
  const title    = item.title || '';
  const price    = item.price || 0;
  const link     = affLink(item.permalink);
  const inst     = item.installments;
  const instText = inst ? inst.quantity+'x de '+fmtPrice(inst.amount)+' sem juros' : '';

  const badges = [];
  if(isCheapest) badges.push('<span class="badge badge-cheap">âœ… MAIS BARATO</span>');
  if(item.sold_quantity && item.sold_quantity > 500)
    badges.push('<span class="badge badge-hot">ğŸ”¥ TOP</span>');
  const ribbon = badges.length ? '<div class="card-ribbon">'+badges.join('')+'</div>' : '';

  const noImg = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='180'%3E%3Crect fill='%23ffffff06' width='200' height='180'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='%23555' font-size='48'%3E%F0%9F%93%A6%3C/text%3E%3C/svg%3E";

  const shopeeUrl = buildShopeeLink(title);
  const magaluUrl = buildMagaluLink(title);
  const sheinUrl  = buildSheinLink(title);

  /* PreÃ§os simulados das outras plataformas (variaÃ§Ã£o realista) */
  const seed      = title.length % 3;
  const shopeeP   = simPrice(price, [2, 8, -3][seed]);
  const magaluP   = simPrice(price, [5, -2, 10][seed]);
  const sheinP    = simPrice(price, [-5, 3, 7][seed]);

  const platformLinks = showPlatformLinks ? `
    <div class="card-platforms">
      <span class="cp-label">ğŸ” Compare em outras lojas:</span>
      <div class="cp-btns">
        <a href="${shopeeUrl}" target="_blank" rel="noopener" class="cp-btn cp-shopee" title="Ver na Shopee">ğŸŸ  Shopee ~${fmtPrice(shopeeP)}</a>
        <a href="${magaluUrl}" target="_blank" rel="noopener" class="cp-btn cp-magalu" title="Ver no Magalu">ğŸ”µ Magalu ~${fmtPrice(magaluP)}</a>
        <a href="${sheinUrl}"  target="_blank" rel="noopener" class="cp-btn cp-shein"  title="Ver na Shein">ğŸ©· Shein ~${fmtPrice(sheinP)}</a>
      </div>
    </div>` : '';

  return `
<div class="card${isCheapest?' card-cheapest':''}">
  ${ribbon}
  <img class="card-img" src="${img}" alt="${title.replace(/"/g,"'")}" onerror="this.src='${noImg}'">
  <div class="card-body">
    <span class="card-store store-ml">ğŸŸ¡ Mercado Livre</span>
    <div class="card-title">${title}</div>
    <div class="card-price">${fmtPrice(price)}</div>
    ${instText?'<div class="card-installment">ğŸ”„ '+instText+'</div>':''}
    <a class="card-btn" href="${link}" target="_blank" rel="noopener sponsored">Ver no ML â†’</a>
    ${platformLinks}
  </div>
</div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RENDER GRID â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderGrid(id, items, sort='asc', showPlatformLinks=false){
  const el = document.getElementById(id);
  if(!items||items.length===0){
    el.innerHTML='<div class="empty-box"><div class="icon">ğŸ˜•</div><h3>Nada encontrado</h3><p>Tente outro termo de busca</p></div>';
    return;
  }
  let sorted=[...items];
  if(sort==='asc')  sorted.sort((a,b)=>a.price-b.price);
  if(sort==='desc') sorted.sort((a,b)=>b.price-a.price);
  el.innerHTML=sorted.map((item,i)=>createCard(item,sort==='asc'&&i===0, showPlatformLinks)).join('');
}
function renderLoading(id,msg='Carregando...'){
  document.getElementById(id).innerHTML=
    '<div class="loading"><div class="spinner"></div><p>'+msg+'</p></div>';
}
function renderError(id, query=''){
  const ml  = query ? buildMlSearchLink(query)   : '#';
  const sh  = query ? buildShopeeLink(query)      : '#';
  const mg  = query ? buildMagaluLink(query)      : '#';
  const sn  = query ? buildSheinLink(query)       : '#';
  document.getElementById(id).innerHTML=`
    <div class="error-box" style="grid-column:1/-1;padding:36px 20px;">
      <h3>âš ï¸ NÃ£o foi possÃ­vel carregar via API</h3>
      <p style="margin:10px 0 22px;color:#aaa;">Busque diretamente nas plataformas:</p>
      <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;">
        <a href="${ml}" target="_blank" rel="noopener" style="padding:11px 22px;background:#ffe600;color:#000;border-radius:10px;font-weight:800;text-decoration:none;">ğŸŸ¡ Mercado Livre</a>
        <a href="${sh}" target="_blank" rel="noopener" style="padding:11px 22px;background:#ee4d2d;color:#fff;border-radius:10px;font-weight:800;text-decoration:none;">ğŸŸ  Shopee</a>
        <a href="${mg}" target="_blank" rel="noopener" style="padding:11px 22px;background:#0086ff;color:#fff;border-radius:10px;font-weight:800;text-decoration:none;">ğŸ”µ Magalu</a>
        <a href="${sn}" target="_blank" rel="noopener" style="padding:11px 22px;background:#ff0066;color:#fff;border-radius:10px;font-weight:800;text-decoration:none;">ğŸ©· Shein</a>
      </div>
    </div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPARADOR DE PLATAFORMAS (painel de resumo)
   Mostra preÃ§o real do ML + preÃ§os simulados
   das outras plataformas â€” do mais barato ao mais caro
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildCompareSection(query, mlItems){
  if(!query) return;
  if(!mlItems || mlItems.length === 0) return;

  const cheapestML = [...mlItems].sort((a,b)=>a.price-b.price)[0];
  const mlPrice    = cheapestML.price;
  const seed       = query.length % 3;

  /* PreÃ§os simulados das concorrentes com variaÃ§Ã£o realista */
  const platforms = [
    {
      id:'ml', emoji:'ğŸŸ¡', name:'Mercado Livre', cls:'btn-ml',
      priceNum: mlPrice,
      priceStr: fmtPrice(mlPrice),
      link: affLink(cheapestML.permalink),
      isReal: true
    },
    {
      id:'shopee', emoji:'ğŸŸ ', name:'Shopee', cls:'btn-shopee',
      priceNum: simPrice(mlPrice, [4, 9, -2][seed]),
      priceStr: '',
      link: buildShopeeLink(query),
      isReal: false
    },
    {
      id:'magalu', emoji:'ğŸ”µ', name:'Magazine Luiza', cls:'btn-magalu',
      priceNum: simPrice(mlPrice, [7, -3, 12][seed]),
      priceStr: '',
      link: buildMagaluLink(query),
      isReal: false
    },
    {
      id:'shein', emoji:'ğŸ©·', name:'Shein', cls:'btn-shein',
      priceNum: simPrice(mlPrice, [-4, 6, 3][seed]),
      priceStr: '',
      link: buildSheinLink(query),
      isReal: false
    }
  ];

  /* preenche priceStr dos simulados */
  platforms.forEach(p=>{ if(!p.priceStr) p.priceStr = '~' + fmtPrice(p.priceNum); });

  /* ordena do mais barato ao mais caro */
  platforms.sort((a,b)=>a.priceNum - b.priceNum);

  document.getElementById('compareSection').style.display='block';
  document.getElementById('compareRows').innerHTML = platforms.map((p,i)=>`
    <div class="compare-row">
      <div class="compare-store">
        <span style="font-size:1.1rem;font-weight:900;color:#888;min-width:22px;">#${i+1}</span>
        ${p.emoji} ${p.name}
        ${i===0?'<span class="compare-cheapest-label">âœ… MAIS BARATO</span>':''}
      </div>
      <div class="compare-price">
        ${p.priceStr}
        ${!p.isReal?'<span style="font-size:0.65rem;color:#666;display:block;">estimativa</span>':''}
      </div>
      <a class="compare-btn ${p.cls}" href="${p.link}" target="_blank" rel="noopener sponsored">
        ${p.id==='ml'?'Ver Oferta â†’':'Buscar â†’'}
      </a>
    </div>
  `).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BUSCA PRINCIPAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function doSearch(query){
  query=(query||'').trim();
  if(!query){showToast('âš ï¸ Digite um produto!');return;}
  currentQuery=query;

  document.getElementById('heroSearch').value   = query;
  document.getElementById('headerSearch').value = query;

  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.mobile-nav-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('page-search').classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});

  document.getElementById('searchTitle').textContent = 'Resultados para "'+query+'"';
  document.getElementById('resultCount').textContent = 'Buscando...';
  document.getElementById('compareSection').style.display = 'none';
  renderLoading('searchResults','Buscando produtos...');

  document.querySelectorAll('#page-search .order-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('#page-search .order-btn')[0].classList.add('active');

  try{
    const items = await fetchML(query, 20);
    currentSearchData = items;
    const cnt = items.length;
    document.getElementById('resultCount').textContent = cnt ? cnt+' resultados' : 'Nenhum resultado';
    document.getElementById('count-ml').textContent    = cnt ? '('+cnt+')' : '';
    /* showPlatformLinks=true â†’ cada card mostra botÃµes Shopee/Magalu/Shein */
    renderGrid('searchResults', items, 'asc', true);
    buildCompareSection(query, items);
  }catch(e){
    renderError('searchResults', query);
    document.getElementById('resultCount').textContent = 'Erro â€” busque direto';
  }
}

function sortProducts(order, btn){
  document.querySelectorAll('#page-search .order-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  renderGrid('searchResults', currentSearchData, order==='rel'?'none':order, true);
}

function showPlatform(p){
  if(p==='ml') document.getElementById('tab-ml').className='ptab active-ml';
}

function openPlatformSearch(platform){
  if(!currentQuery){showToast('âš ï¸ FaÃ§a uma busca primeiro!');return;}
  const urls = {
    shopee: buildShopeeLink(currentQuery),
    magalu: buildMagaluLink(currentQuery),
    shein:  buildSheinLink(currentQuery)
  };
  if(urls[platform]) window.open(urls[platform],'_blank','noopener,noreferrer');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadHome(){
  renderLoading('homeHighlights','Carregando destaques...');
  renderLoading('homeTrending','Carregando em alta...');
  try{
    const h = await fetchML('smartphone samsung',8);
    renderGrid('homeHighlights', h, 'asc');
  }catch(e){ renderError('homeHighlights','smartphone'); }

  try{
    const t = await fetchML('notebook gamer',8);
    renderGrid('homeTrending', t, 'asc');
  }catch(e){ renderError('homeTrending','notebook gamer'); }
}

function selectChip(el,query){
  document.querySelectorAll('#homeChips .chip').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');
  if(query) doSearch(query);
  else loadHome();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OFERTAS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadOfertas(query){
  renderLoading('ofertasGrid','Carregando ofertas...');
  try{
    const items = await fetchML(query,16);
    renderGrid('ofertasGrid', items, 'asc');
  }catch(e){ renderError('ofertasGrid', query); }
}
function selectOfertaChip(el,query){
  document.querySelectorAll('#ofertasChips .chip').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');
  loadOfertas(query);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIS BUSCADOS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadMaisBuscados(query){
  renderLoading('maisBuscadosGrid','Carregando...');
  try{
    const items = await fetchML(query,16);
    renderGrid('maisBuscadosGrid', items, 'asc');
  }catch(e){ renderError('maisBuscadosGrid', query); }
}
function selectBuscadoChip(el,query){
  document.querySelectorAll('#buscadosChips .chip').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');
  loadMaisBuscados(query);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIS VENDIDOS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadMaisVendidos(query){
  renderLoading('maisVendidosGrid','Carregando mais vendidos...');
  document.querySelectorAll('#page-mais-vendidos .order-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('#page-mais-vendidos .order-btn')[0].classList.add('active');
  try{
    const items = await fetchML(query,16,'sold_quantity_desc');
    currentVendidoData = items;
    renderGrid('maisVendidosGrid', items, 'asc');
  }catch(e){
    try{
      const items2 = await fetchML(query,16);
      currentVendidoData = items2;
      renderGrid('maisVendidosGrid', items2, 'asc');
    }catch(e2){ renderError('maisVendidosGrid', query); }
  }
}
function sortMaisVendidos(order,btn){
  document.querySelectorAll('#page-mais-vendidos .order-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  renderGrid('maisVendidosGrid', currentVendidoData, order);
}
function selectVendidoChip(el,query){
  document.querySelectorAll('#vendidosChips .chip').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');
  loadMaisVendidos(query);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CUPONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loadCupons(){
  const coupons=[
    {icon:'ğŸŸ¡',store:'Mercado Livre',desc:'Frete grÃ¡tis em todo o site',code:'MLFRETE',savings:'Frete GrÃ¡tis'},
    {icon:'ğŸ’³',store:'Mercado Pago', desc:'10% OFF pagando com Mercado Pago',code:'MP10OFF',savings:'10% OFF'},
    {icon:'ğŸ“±',store:'Mercado Livre',desc:'PromoÃ§Ã£o exclusiva em smartphones',code:'CELULAR15',savings:'15% OFF'},
    {icon:'ğŸ®',store:'Mercado Livre',desc:'Desconto em games e consoles',code:'GAME20',savings:'20% OFF'},
    {icon:'ğŸ’»',store:'Mercado Livre',desc:'Notebooks e computadores em oferta',code:'TECH25',savings:'25% OFF'},
    {icon:'ğŸ ',store:'Mercado Livre',desc:'Casa, jardim e decoraÃ§Ã£o',code:'CASA10',savings:'10% OFF'},
    {icon:'ğŸ‘Ÿ',store:'Mercado Livre',desc:'Moda e acessÃ³rios com desconto',code:'MODA12',savings:'12% OFF'},
    {icon:'ğŸ“¦',store:'Mercado Livre',desc:'Primeiros pedidos com desconto',code:'NOVO30',savings:'30% OFF'},
  ];
  document.getElementById('cuponsGrid').innerHTML=coupons.map(c=>`
    <div class="coupon-card">
      <div class="coupon-icon">${c.icon}</div>
      <div class="coupon-info">
        <h4>${c.store}</h4>
        <p>${c.desc}</p>
        <div class="coupon-savings">ğŸ’° ${c.savings}</div>
        <div class="coupon-code" onclick="copyCode('${c.code}')">ğŸ“‹ ${c.code}</div>
      </div>
    </div>`).join('');
  loadCuponsProducts();
}
async function loadCuponsProducts(){
  try{
    const items = await fetchML('promoÃ§Ã£o',8);
    renderGrid('cuponsProducts', items, 'asc');
  }catch(e){ renderError('cuponsProducts','promoÃ§Ã£o'); }
}
function copyCode(code){
  navigator.clipboard.writeText(code)
    .then(()=>showToast('âœ… Cupom "'+code+'" copiado!'))
    .catch(()=>showToast('Cupom: '+code));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAVEGAÃ‡ÃƒO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function goPage(page){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.mobile-nav-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('page-'+page).classList.add('active');
  const map={home:0,ofertas:1,'mais-buscados':2,'mais-vendidos':3,cupons:4};
  if(map[page]!==undefined){
    document.querySelectorAll('nav button')[map[page]].classList.add('active');
    document.querySelectorAll('.mobile-nav-btn')[map[page]].classList.add('active');
  }
  window.scrollTo({top:0,behavior:'smooth'});
  if(page==='ofertas')       loadOfertas('smartphone');
  if(page==='mais-buscados') loadMaisBuscados('iPhone');
  if(page==='mais-vendidos') loadMaisVendidos('eletronico');
  if(page==='cupons')        loadCupons();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TOAST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),3200);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INIT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.addEventListener('DOMContentLoaded',()=>{
  loadHome();
  document.getElementById('heroSearch').addEventListener('keydown',e=>{
    if(e.key==='Enter') doSearch(e.target.value);
  });
  document.getElementById('headerSearch').addEventListener('keydown',e=>{
    if(e.key==='Enter') doSearch(e.target.value);
  });
});
</script>
</body>
</html>





